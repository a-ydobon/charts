<html>
<head>
<!--Load the AJAX API-->
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
// Load the Visualization API and the corechart package.
google.charts.load('current', {'packages':['corechart']});
// Set a callback to run when the Google Visualization API is loaded.
google.charts.setOnLoadCallback(animate1);

function animate1() {
  
  var queryString = encodeURIComponent('SELECT C:D');
  var query = new google.visualization.Query(
          'https://docs.google.com/spreadsheets/d/1-Gq_ZqXpQocgDN04H0VTcAyEZBjT6RIItrakuuBlyPg/edit?usp=sharing' + queryString);
      query.send(handleSampleDataQueryResponse);
    }

  function handleSampleDataQueryResponse(response) {
    if (response.isError()) {
      document.write('error'+'<br />');
      alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
      return;
    }

  var data = response.getDataTable();
    
  document.write(data + '<br />');
  var chart = new google.visualization.BarChart(document.getElementById('chart_div'));
  chart.draw(data, { height: 400, animation: {startup: true, duration: 500, easing: 'linear'} });
    
  //var rawData1 = [['1990', '서울'],
  //                ['남자', 100],
  //                ['여자', 90]];
  //var rawData2 = [['2090', '서울'],
  //                ['남자', 110],
  //                ['여자', 190]];
  
  //var data = [];
    
  //data[0] = google.visualization.arrayToDataTable(rawData1);
  //data[1] = google.visualization.arrayToDataTable(rawData2);

  
  //var options = {
  //  title: 'Year 2000',
  //  animation:{
  //    startup: true,
  //    duration: 100,
  //    easing: 'linear'
  //  },
  //  bars: 'horizontal' // Required for Material Bar Charts.
  //}
  
  //var chart = new google.visualization.BarChart(document.getElementById('chart_div'));
  //chart.draw(data[0], options);
  
  
  //var options1 = {
  //  title: 'Year 9999',
  //  animation:{
  //    duration: 500,
  //    easing: 'out'
  //  },
  //  bars: 'horizontal' // Required for Material Bar Charts.
  //}
  
  //google.visualization.events.addListener(chart, 'animationfinish', for_loop1);
  
  //function for_loop1() {
  //  chart.draw(data[1], options1);
  //}
}
</script>
</head>

<body>
  <!--Div that will hold the pie chart-->
  <div id="chart_div", style="width: 900px; height: 500px;"></div>
</body>
</html>
